{
    "messages": [
        {
            "role": "user",
            "content": "how many yards did Josh Allen throw for in 2023"
        },
        {
            "role": "assistant",
            "content": "{'Player': { '$regex': '^Josh Allen', '$options': 'i' }, 'season_year': '2023'} /* Annotation: Show all stats for Josh Allen, using a partial match on his name as full name would require team neam e.g. Josh Allen (BUF) */"
        }
    ]
}


[
    {
        "user": "how many yards did Josh Allen throw for in 2023",
        "system": "{'Player': { '$regex': '^Josh Allen', '$options': 'i' }, 'season_year': '2023'}"
    },
    {
        "user": "who were the top 3 WR's by yards per catch in 2022",
        "system": "[{'$match':{'season_year':'2022'}},{'$sort':{'Y/R':-1}},{'$limit':3},{'$project':{'_id':0,'Player':1,'Y/R':1,'YDS':1,'REC':1}}]"
    },
    {
        "user": "what rb had the greatest number of increases in rushing attempts from 2022 to 2023?",
        "system": "[{'$match':{'season_year':{'$in':[2022,2023]}}},{'$group':{'_id':'$Player','att_2022':{'$max':{'$cond':[{'$eq':['$season_year',2022]},'$ATT',null]}},'att_2023':{'$max':{'$cond':[{'$eq':['$season_year',2023]},'$ATT',null]}}}},{'$project':{'Player':'$_id','att_diff':{'$subtract':['$att_2023','$att_2022']},'att_2022':1,'att_2023':1}},{'$sort':{'att_diff':-1}},{'$limit':1}]"
    },
    {
        "user": "who was the best fantasy qb in 2023",
        "system": "[{'$match':{'season_year':2023,'position':'QB'}},{'$sort':{'FPTS':-1}},{'$limit':1},{'$project':{'_id':0,'Player':1,'FPTS':1}}]"
    },
    {
        "user": "what were the top 3 rbs for yards per carry (min 100 attempts)",
        "system": "[{'$match':{'position':'RB','RUSH_ATT':{'$gte':100}}},{'$sort':{'RUSH_Y/A':-1}},{'$limit':3},{'$project':{'_id':0,'Player':1,'Y/A':'$RUSH_Y/A','ATT':'$RUSH_ATT','YDS':'$RUSH_YDS'}}]"
    },
    {
        "user": "what WR had the biggest drop off in yardage from 2022 to 2023",
        "system": "[{'$match':{'season_year':{'$in':[2022,2023]},'position':'WR'}},{'$group':{'_id':'$Player','yds_2022':{'$max':{'$cond':[{'$eq':['$season_year',2022]},'$REC_YDS',0]}},'yds_2023':{'$max':{'$cond':[{'$eq':['$season_year',2023]},'$REC_YDS',0]}}}},{'$project':{'Player':'$_id','yardage_decrease':{'$subtract':[{'$toInt':{'$ifNull':['$yds_2023',0]}},{'$toInt':{'$ifNull':['$yds_2022',0]}}]},'yds_2022':1,'yds_2023':1}},{'$sort':{'yardage_decrease':1}},{'$limit':1}]"
    },
    {
        "user": "what QB had the biggest drop off in yardage from 2022 to 2023",
        "system": "[{'$match':{'season_year':{'$in':[2022,2023]},'position':'QB'}},{'$group':{'_id':'$Player','yds_2022':{'$max':{'$cond':[{'$eq':['$season_year',2022]},'$PASS_YDS',0]}},'yds_2023':{'$max':{'$cond':[{'$eq':['$season_year',2023]},'$PASS_YDS',0]}}}},{'$project':{'Player':'$_id','yardage_decrease':{'$subtract':[{'$toInt':{'$ifNull':['$yds_2023',0]}},{'$toInt':{'$ifNull':['$yds_2022',0]}}]},'yds_2022':1,'yds_2023':1}},{'$sort':{'yardage_decrease':1}},{'$limit':1}]"
    },
    {
        "user": "who were the 3 WRs with the biggest increased in targets from 2022 to 2023",
        "system": "[{'$match':{'season_year':{'$in':[2022,2023]},'position':'WR'}},{'$group':{'_id':'$Player','tgt_2022':{'$max':{'$cond':[{'$eq':['$season_year',2022]},'$REC_TGT',null]}},'tgt_2023':{'$max':{'$cond':[{'$eq':['$season_year',2023]},'$REC_TGT',null]}}}},{'$project':{'Player':'$_id','target_increase':{'$subtract':['$tgt_2023','$tgt_2022']},'tgt_2022':1,'tgt_2023':1}},{'$match':{'target_increase':{'$gt':0}}},{'$sort':{'target_increase':-1}},{'$limit':3}]"
    },
    {
        "user": "who were the 3 WRs with the biggest increased in targets from 2022 to 2023",
        "system": "[{'$match':{'season_year':{'$in':[2022,2023]},'position':'RB'}},{'$group':{'_id':'$Player','td_2022':{'$max':{'$cond':[{'$eq':['$season_year',2022]},'$RUSH_TD',null]}},'td_2023':{'$max':{'$cond':[{'$eq':['$season_year',2023]},'$RUSH_TD',null]}}}},{'$project':{'Player':'$_id','td_increase':{'$subtract':['$td_2023','$td_2022']},'td_2022':1,'td_2023':1}},{'$match':{'td_increase':{'$gt':0}}},{'$sort':{'td_increase':-1}},{'$limit':3}]"
    },
    {
        "user": "where did bijan robinson rank in receiving yards last year about rbs?",
        "system": "[{'$match':{'season_year':2023,'position':'RB'}},{'$sort':{'REC_YDS':-1}},{'$group':{'_id':'$Player','REC_YDS':{'$first':'$REC_YDS'}}},{'$setWindowFields':{'partitionBy':null,'sortBy':{'REC_YDS':-1},'output':{'rank':{'$rank':{}}}}},{'$match':{'_id':'Bijan Robinson (ATL)'}},{'$project':{'_id':0,'Player':'$_id','Rank':'$rank'}}]"
    },
    {
        "user": "where did lamar jackson rank in rushing yards last year about qbs?",
        "system": "[{'$match':{'season_year':2023,'position':'QB'}},{'$sort':{'RUSH_YDS':-1}},{'$group':{'_id':'$Player','RUSH_YDS':{'$first':'$RUSH_YDS'}}},{'$setWindowFields':{'partitionBy':null,'sortBy':{'RUSH_YDS':-1},'output':{'rank':{'$rank':{}}}}},{'$match':{'_id':'Lamar Jackson (BAL)'}},{'$project':{'_id':0,'Player':'$_id','Rank':'$rank'}}][{'Player':'Lamar Jackson (BAL)','Rank':1}] (make sure you get the right number of closing brackets following  $rank it should be (pay close attention to this part as it's often a mistake '$rank':{}}}}} tht's five consecutive }"
    },
    {
        "user": "who were the top 5 most improved RB's from 2022 to 2023 in fantasy points",
        "system": "[{'$match':{'season_year':{'$in':[2022,2023]},'position':'RB'}},{'$group':{'_id':'$Player','fpts_2022':{'$max':{'$cond':[{'$eq':['$season_year',2022]},'$FPTS',null]}},'fpts_2023':{'$max':{'$cond':[{'$eq':['$season_year',2023]},'$FPTS',null]}}}},{'$project':{'Player':'$_id','fpts_increase':{'$subtract':['$fpts_2023','$fpts_2022']},'fpts_2022':1,'fpts_2023':1}},{'$match':{'fpts_increase':{'$gt':0}}},{'$sort':{'fpts_increase':-1}},{'$limit':5}]"
    },
    {
        "user": "who were the five most disapointing WRs in 2023 (biggest drop in fantasy points from 2022)",
        "system": "[{'$match':{'season_year':{'$in':[2022,2023]},'position':'WR'}},{'$group':{'_id':'$Player','fpts_2022':{'$max':{'$cond':[{'$eq':['$season_year',2022]},'$FPTS',null]}},'fpts_2023':{'$max':{'$cond':[{'$eq':['$season_year',2023]},'$FPTS',null]}}}},{'$project':{'Player':'$_id','fpts_decrease':{'$subtract':['$fpts_2022','$fpts_2023']},'fpts_2022':1,'fpts_2023':1}},{'$match':{'fpts_decrease':{'$gt':0}}},{'$sort':{'fpts_decrease':-1}},{'$limit':5}]"
    },
    {
        "user": "which 3 WRs have the highest avg fantasy points from last 3 years",
        "system": "[{'$match':{'position':'WR','season_year':{'$gte':2021,'$lte':2023}}},{'$group':{'_id':'$Player','avgFPTS':{'$avg':'$FPTS'},'totalFPTS':{'$sum':'$FPTS'}}},{'$sort':{'avgFPTS':-1}},{'$limit':3},{'$project':{'_id':0,'Player':'$_id','avgFPTS':1,'totalFPTS':1}}]"
    },
    {
        "user": "Among receivers who ranked outside the top 10 in fantasy points, which 5 WR had the most targets?",
        "system": "[{'$match':{'position':'WR','Rank':{'$gt':10}}},{'$sort':{'REC_TGT':-1}},{'$limit':5},{'$project':{'_id':0,'Player':1,'REC_TGT':1,'FPTS':1}}]",
    },
    {
        "user": "what WRs are the least td dependent (i.e. what 5 receivers had the highest fantasy points : td ratio (min 4 tds)?. show their ratio, points, receptions, yards, tds",
        "system": "[{'$match':{'position':'WR','REC_TD':{'$gte':4}}},{'$project':{'_id':0,'Player':1,'FPTS':1,'REC_REC':1,'REC_YDS':1,'REC_TD':1,'FPTS_TD_RATIO':{'$divide':['$FPTS','$REC_TD']}}},{'$sort':{'FPTS_TD_RATIO':-1}},{'$limit':5}]"
    },
    {
        "user": "what 5 rb had the highest fantasy points : td ratio (min 4 tds)?. show their ratio, points, atts, yards, tds",
        "system": "[{'$match':{'position':'RB','RUSH_TD':{'$gte':4}}},{'$project':{'_id':0,'Player':1,'FPTS':1,'RUSH_ATT':1,'RUSH_YDS':1,'RUSH_TD':1,'FPTS_TD_RATIO':{'$divide':['$FPTS','$RUSH_TD']}}},{'$sort':{'FPTS_TD_RATIO':-1}},{'$limit':5}]"
    },
    {
        "user": "what 5 rb had the highest fantasy points : td ratio (min 4 tds)?. show their ratio, points, atts, yards, tds",
        "system": "[{'$match':{'position':'RB','RUSH_TD':{'$gte':4}}},{'$project':{'_id':0,'Player':1,'FPTS':1,'RUSH_ATT':1,'RUSH_YDS':1,'RUSH_TD':1,'FPTS_TD_RATIO':{'$divide':['$FPTS','$RUSH_TD']}}},{'$sort':{'FPTS_TD_RATIO':-1}},{'$limit':5}]"
    },
    {
        "user": "what rb had the most receiving tds in 2021 and 2022",
        "system": "[{'$match':{'season_year':{'$in':[2021,2022]},'position':'RB'}},{'$group':{'_id':'$Player','total_rec_tds':{'$sum':'$REC_TD'}}},{'$sort':{'total_rec_tds':-1}},{'$limit':1},{'$project':{'_id':0,'Player':'$_id','total_receiving_tds':'$total_rec_tds'}}"
    }
]